# encoding: utf-8

patch:
  "switches/@0/reset": 0
  "switches/@1/reset": 0

  translator/dictionary: rime_s
  translator/initial_quality: 1.2
  translator/prism: double_pinyin_flypy
  translator/preedit_format: {}
  translator/enable_completion: true

  switches/@next:
    name: emoji
    reset: 1
    states: [ "üíÄ", "üòÑ" ]

  # https://github.com/rime/rime-emoji/blob/master/emoji.yaml
  emoji:
    opencc_config: emoji.json
    option_name: emoji
    tips: none
    inherit_comment: false

  # https://github.com/BlindingDark/rime-lua-select-character
  key_binder/select_first_character: 'minus'
  key_binder/select_last_character: 'equal'

  # https://github.com/functoreality/rime-flypy-zrmfast/
  schema/dependencies/+:
    - chaizi
    - melt_eng

  reverse_lookup/dictionary: chaizi_flypy
  reverse_lookup/prefix: "U"
  reverse_lookup/enable_completion: true
  reverse_lookup/tips: []
  reverse_lookup/preedit_format:
    - xform/([nljqxy])v/$1√º/
  reverse_lookupcomment_format:
    - xform/([nljqxy])v/$1√º/

  # https://github.com/hchunhui/librime-lua
  # https://github.com/LufsX/rime/blob/master/lufs_flypy.schema.yaml
  # https://dvel.me/posts/make-rime-en-better
  melt_eng:
    dictionary: melt_eng
    enable_sentence: false
    enable_user_dict: false
    initial_quality: 1.1
    comment_format:
      - xform/.*//

  traditionalize:
    option_name: traditionalization
    opencc_config: s2t.json
    tips: none
    excluded_types: [ reverse_lookup ]
  switches/@2:
    name: traditionalization
    reset: 0
    states: [ "ÁÆÄ", "ÁπÅ" ]

  engine:
    filters:
      - simplifier@emoji
      - simplifier@traditionalize
      - lua_filter@autocap_filter
      - lua_filter@reduce_english_filter
      - uniquifier
    processors:
      - lua_processor@select_character_processor
      - ascii_composer
      - recognizer
      - key_binder
      - speller
      - punctuator
      - selector
      - navigator
      - express_editor
    segmentors:
      - ascii_segmentor
      - matcher
      - abc_segmentor
      - punct_segmentor
      - fallback_segmentor
    translators:
      - punct_translator
      - script_translator
      - lua_translator@date_translator
      - table_translator@melt_eng
      - reverse_lookup_translator

  recognizer:
    patterns:
      email: "^[A-Za-z][-_.0-9A-Za-z]*@.*$"
      reverse_lookup: "^U[a-z]+$"
      # uppercase: "[A-Z][-_+.'0-9A-Za-z]*$"
      url: "^(www[.]|https?:|ftp[.:]|mailto:|file:).*$|^[a-z]+[.].+$"

  speller:
    algebra:
      - "erase/^xx$/"
      - "derive/^([jqxy])u$/$1v/"
      - "derive/^([aoe])([ioun])$/$1$1$2/"
      - "xform/^([aoe])(ng)?$/$1$1$2/"
      - "xform/iu$/Q/"
      - "xform/(.)ei$/$1W/"
      - "xform/uan$/R/"
      - "xform/[uv]e$/T/"
      - "xform/un$/Y/"
      - "xform/^sh/U/"
      - "xform/^ch/I/"
      - "xform/^zh/V/"
      - "xform/uo$/O/"
      - "xform/ie$/P/"
      - "xform/i?ong$/S/"
      - "xform/ing$|uai$/K/"
      - "xform/(.)ai$/$1D/"
      - "xform/(.)en$/$1F/"
      - "xform/(.)eng$/$1G/"
      - "xform/[iu]ang$/L/"
      - "xform/(.)ang$/$1H/"
      - "xform/ian$/M/"
      - "xform/(.)an$/$1J/"
      - "xform/(.)ou$/$1Z/"
      - "xform/[iu]a$/X/"
      - "xform/iao$/N/"
      - "xform/(.)ao$/$1C/"
      - "xform/ui$/V/"
      - "xform/in$/B/"
      - "xlit/QWRTYUIOPSDFGHJKLZXCVBNM/qwrtyuiopsdfghjklzxcvbnm/"
      # - "abbrev/^(.).+$/$1/" # È¶ñÂ≠óÊØçÁÆÄÊãº
    alphabet: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA
    delimiter: " '"
      
  # ÂÖ´ËÇ°Êñá
  grammar:
    language: zh-hans-t-essay-bgw
  translator/contextual_suggestions: true
  translator/max_homophones: 7
  translator/max_homographs: 7

  # Ëá™ÂÆö‰πâÁ¨¶Âè∑
  punctuator:
    import_preset: default
    full_shape:
      "/" : "Ôºè"
      "\\" : "„ÄÅ"
      "[" : "„Äå"
      "]" : "„Äç"
      "{" : "„Äé"
      "}" : "„Äè"
      "*" : "Ôºä"
      "<" : "„Ää"
      ">" : "„Äã"
      "~" : "~"
      "$" : "Ôø•"
      "%" : "ÔºÖ"
      "|" : "¬∑"
    half_shape:
      "/" : "/"
      "\\" : "„ÄÅ"
      "[" : "„Äå"
      "]" : "„Äç"
      "{" : "„Äé"
      "}" : "„Äè"
      "*" : "*"
      "<" : "„Ää"
      ">" : "„Äã"
      "~" : "~"
      "$" : "$"
      "%" : "%"
      "|" : "¬∑"

  ascii_composer:
    good_old_caps_lock: true
    switch_key:
      Shift_L: noop
      Shift_R: noop
      Control_L: noop
      Control_R: inline_ascii
      Caps_Lock: clear
      Eisu_toggle: clear
